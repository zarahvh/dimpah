
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analysing Historical Cultures 1 &#8212; DIMPAH</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Analysing Historical Cultures 2" href="Text_2.html" />
    <link rel="prev" title="Historical Cultures" href="../../HistoricalCultures.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">DIMPAH</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Intro
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../Communities_of_Digital_Cultures_and_Society.html">
   Communities of Digital Cultures and Society
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ass3/Communities_of_Digital_Culture_and_Society_1.html">
     Detecting Political Communities of Practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ass3/Communities_of_Digital_Culture_and_Society_2.html">
     Social Data from the Web
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../SocialSensing.html">
   Social Sensing
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../SocialMedia/Social_Sensing_1.html">
     Social Sensing 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SocialMedia/Social_Sensing_2.html">
     Social Sensing 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../../HistoricalCultures.html">
   Historical Cultures
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Analysing Historical Cultures 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Text_2.html">
     Analysing Historical Cultures 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../VisualsArts.html">
   Visuals Arts
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../VisualsArts/Visuals_and_Arts_1.html">
     Visuals and Arts 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../VisualsArts/Visuals_and_Arts_2.html">
     Visuals and Arts 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../PredictingModelling.html">
   PredictingModelling
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../PredictingModelling/Predicting_Modelling_1.html">
     Predicting Modelling 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PredictingModelling/Predicting_Modelling_2.html">
     Predicting and Modelling using Deep Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../PredictingModelling/Predicting_Modelling_2.html#decision-boundaries">
     Decision Boundaries
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Notebooks/Text/Text_1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/zarahvh/dimpah"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/zarahvh/dimpah/issues/new?title=Issue%20on%20page%20%2FNotebooks/Text/Text_1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/zarahvh/dimpah/master?urlpath=tree/Notebooks/Text/Text_1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="analysing-historical-cultures-1">
<h1>Analysing Historical Cultures 1<a class="headerlink" href="#analysing-historical-cultures-1" title="Permalink to this headline">¶</a></h1>
<p>Today we work on historical cultures. The methods are not very different from social analytics, which we have already discussed. But the data is often only available in texts, as your readings have discussed. That’s why we use this opportunity to concentrate on how to analyse texts.</p>
<p>We have already talked about texts a little bit when we were looking at how to analyse the content of tweets. In this session, we will finally find out how to be able to do this by ourselves. Text analysis is an advanced field in the world of computational analytics, and we can rely on a very long tradition of doing text analysis and very established methods. Besides, it is fun and maybe at the same time the dominant form in social and cultural analytics – simply because we work so much with texts, documents, etc.</p>
<p>We will go back further in history and mainly work the US State of the Union Address. This allows to first of all understand a lot about the past state of the political constitution of the USA. The State of the Union (SOTU) data is taken from <a class="reference external" href="http://stateoftheunion.onetwothree.net/index.shtml">http://stateoftheunion.onetwothree.net/index.shtml</a> and provides access to the corpus of all the State of the Union addresses from 1790 to 2015 at the time of writing. SOTU allows you to explore how specific words gain and lose prominence over time, and to link to information on the historical context for their use.</p>
<p>We did all the hard work of loading this data for you. It should be available to you as the data frame sotu_all.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<!-- The dataframe is an rdata file, which python cannot read, luckily python has a package for this.
(Are we going to let the students take this step or do we provide them with a csv file?)
Check out the file, after converting it into a pandas dataframe, by using head() and you will see three columns. The first one contains the full text, the second one the year and the third the exact date in the format YYYYMMDD. --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import pyreadr</span>

<span class="c1"># data = pyreadr.read_r(&#39;data/sotu_all.rda&#39;) </span>

<span class="c1"># df = data[&#39;sotu_all&#39;]</span>
<span class="c1"># df.head()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/sotu_all.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rownames</th>
      <th>speechtext</th>
      <th>year</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17900108.html</td>
      <td>Fellow-Citizens of the Senate and House of Re...</td>
      <td>1790</td>
      <td>17900108</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17901208.html</td>
      <td>Fellow-Citizens of the Senate and House of Re...</td>
      <td>1790</td>
      <td>17901208</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17911025.html</td>
      <td>Fellow-Citizens of the Senate and House of Re...</td>
      <td>1791</td>
      <td>17911025</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17921106.html</td>
      <td>Fellow-Citizens of the Senate and House of Re...</td>
      <td>1792</td>
      <td>17921106</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17931203.html</td>
      <td>Fellow-Citizens of the Senate and House of Re...</td>
      <td>1793</td>
      <td>17931203</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can see the structure of the datframe, but you cannot completely see what is in the speechtext column. Try and print out the first text entry of the dataframe (speechtext).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;speechtext&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39; Fellow-Citizens of the Senate and House of Representatives: I embrace with great satisfaction the opportunity which now presents itself of congratulating you on the present favorable prospects of our public affairs. The recent accession of the important state of North Carolina to the Constitution of the United States (of which official information has been received), the rising credit and respectability of our country, the general and increasing good will toward the government of the Union, and the concord, peace, and plenty with which we are blessed are circumstances auspicious in an eminent degree to our national prosperity. In resuming your consultations for the general good you can not but derive encouragement from the reflection that the measures of the last session have been as satisfactory to your constituents as the novelty and difficulty of the work allowed you to hope. Still further to realize their expectations and to secure the blessings which a gracious Providence has placed within our reach will in the course of the present important session call for the cool and deliberate exertion of your patriotism, firmness, and wisdom. Among the many interesting objects which will engage your attention that of providing for the common defense will merit particular regard. To be prepared for war is one of the most effectual means of preserving peace. A free people ought not only to be armed, but disciplined; to which end a uniform and well-digested plan is requisite; and their safety and interest require that they should promote such manufactories as tend to render them independent of others for essential, particularly military, supplies. The proper establishment of the troops which may be deemed indispensable will be entitled to mature consideration. In the arrangements which may be made respecting it it will be of importance to conciliate the comfortable support of the officers and soldiers with a due regard to economy. There was reason to hope that the pacific measures adopted with regard to certain hostile tribes of Indians would have relieved the inhabitants of our southern and western frontiers from their depredations, but you will perceive from the information contained in the papers which I shall direct to be laid before you (comprehending a communication from the Commonwealth of Virginia) that we ought to be prepared to afford protection to those parts of the Union, and, if necessary, to punish aggressors. The interests of the United States require that our intercourse with other nations should be facilitated by such provisions as will enable me to fulfill my duty in that respect in the manner which circumstances may render most conducive to the public good, and to this end that the compensation to be made to the persons who may be employed should, according to the nature of their appointments, be defined by law, and a competent fund designated for defraying the expenses incident to the conduct of foreign affairs. Various considerations also render it expedient that the terms on which foreigners may be admitted to the rights of citizens should be speedily ascertained by a uniform rule of naturalization. Uniformity in the currency, weights, and measures of the United States is an object of great importance, and will, I am persuaded, be duly attended to. The advancement of agriculture, commerce, and manufactures by all proper means will not, I trust, need recommendation; but I can not forbear intimating to you the expediency of giving effectual encouragement as well to the introduction of new and useful inventions from abroad as to the exertions of skill and genius in producing them at home, and of facilitating the intercourse between the distant parts of our country by a due attention to the post-office and post-roads. Nor am I less persuaded that you will agree with me in opinion that there is nothing which can better deserve your patronage than the promotion of science and literature. Knowledge is in every country the surest basis of public happiness. In one in which the measures of government receive their impressions so immediately from the sense of the community as in ours it is proportionably essential. To the security of a free constitution it contributes in various ways--by convincing those who are intrusted with the public administration that every valuable end of government is best answered by the enlightened confidence of the people, and by teaching the people themselves to know and to value their own rights; to discern and provide against invasions of them; to distinguish between oppression and the necessary exercise of lawful authority; between burthens proceeding from a disregard to their convenience and those resulting from the inevitable exigencies of society; to discriminate the spirit of liberty from that of licentiousness-- cherishing the first, avoiding the last--and uniting a speedy but temperate vigilance against encroachments, with an inviolable respect to the laws. Whether this desirable object will be best promoted by affording aids to seminaries of learning already established, by the institution of a national university, or by any other expedients will be well worthy of a place in the deliberations of the legislature. Gentlemen of the House of Representatives: I saw with peculiar pleasure at the close of the last session the resolution entered into by you expressive of your opinion that an adequate provision for the support of the public credit is a matter of high importance to the national honor and prosperity. In this sentiment I entirely concur; and to a perfect confidence in your best endeavors to devise such a provision as will be truly with the end I add an equal reliance on the cheerful cooperation of the other branch of the legislature. It would be superfluous to specify inducements to a measure in which the character and interests of the United States are so obviously so deeply concerned, and which has received so explicit a sanction from your declaration. Gentlemen of the Senate and House of Representatives: I have directed the proper officers to lay before you, respectively, such papers and estimates as regard the affairs particularly recommended to your consideration, and necessary to convey to you that information of the state of the Union which it is my duty to afford. The welfare of our country is the great object to which our cares and efforts ought to be directed, and I shall derive great satisfaction from a cooperation with you in the pleasing though arduous task of insuring to our fellow citizens the blessings which they have a right to expect from a free, efficient, and equal government. &#39;
</pre></div>
</div>
</div>
</div>
<p>As we saw above, the dataframe also contains the column ‘year’ and ‘date’.</p>
<p>Let’s check out the types of these values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">year</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.int64&#39;&gt;
&lt;class &#39;numpy.int64&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Both of the types are strings!</p>
<p>But we want the years to be numbers and the dates to be actual dates. This can lead to issues later on when we will analyse the data. Let’s fix that so we can read and use them as the actual date values that they are when analyzing the data later on.</p>
<p>Sotu_all’s date is clearly a date-string in the format YYYYMMDD. Pandas has the powerful pd.to_datetime() function that can parse such character strings and transform them into Python’s date objects. The advantage is that we can then compare dates with each other, add dates to other dates, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can then convert the years into integers by ysing Pandas’ to_numeric() function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Fighting with different formats of date and time is a key part of analysing culture and society. For some past events, for instance, we do not know exact dates or times and have to work with estimates. Sometimes, we only know the approximate time span of when, say, a Roman consul lived. This can cause a lot of issues.</p>
<p>-python package for this?</p>
<p>Runing type() again will confirm  that all the columns are now of the correct type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">year</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas._libs.tslibs.timestamps.Timestamp&#39;&gt;
&lt;class &#39;numpy.int64&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>With sotu_all, we have a collection of documents reflecting over 200 years in the history of the US in the words of each president. It is time to do something with it and text mine it. As said, text mining is a very established discipline. Text Mining is the process of deriving meaningful information from natural language text.</p>
<p>Natural Language Processing is a component of text mining that performs a special kind of linguistic analysis that essentially helps a machine “read” text. The Natural Language Toolkit (NLTK) is a Python package for natural language processing.</p>
<p>-text mining python –&gt; NLTK</p>
<p>In this chapter, we are going to cover some of the most commonly used methods of the NLTK package and employ them to analyse the historical content of the State of the Union speeches. To this end, first we need to create a so-called corpus. A corpus is term originating from the linguistics community. All you need to know about a corpus is that it is basically a collection of text documents. In python, you can create a corpus from many sources (online or local) and from many different formats such as plain text or PDF.
(<a class="reference external" href="https://www.nltk.org">https://www.nltk.org</a>)</p>
<p>If you are interested, please check online for the many ways NLTK is used. For now we will just need ….</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
</div>
</div>
<p>The first task we set ourselves is to understand historical policy differences. The last SOTU address of the Republican George W. Bush was in 2008, while the first one of the Democrat Barack Obama was in 2009. These were also the years of the height of a very severe financial crisis. So, we expect interesting changes in content. To identify these, we would like to produce a word cloud to compare the most frequent terms in both speeches in order to understand policy differences. Let us first create a smaller sample of the data containing only the speeches of 2008 and 2009. We can use pandas df.loc by selecting the rows that contain the column value 2008 or 2009 to create a new sotu_2008_2009 data frame containing only the speeches of 2008 and 2009.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sotu_2008</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2008</span><span class="p">]</span>
<span class="n">sotu_2009</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2009</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we need to create a corpus. For this we first need to tokenize the words, which means we break the text into units, into words. We are only interested in the full texts and thus only need the values of the column speechtext. So let us first get these texts as strings so that afterwards we can tokenize them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speechtext_2008</span> <span class="o">=</span> <span class="n">sotu_2008</span><span class="p">[</span><span class="s1">&#39;speechtext&#39;</span><span class="p">]</span>
<span class="n">text_2008</span> <span class="o">=</span> <span class="n">speechtext_2008</span><span class="o">.</span><span class="n">values</span>
<span class="n">strings_2008</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_2008</span><span class="p">)</span>

<span class="n">speechtext_2009</span> <span class="o">=</span> <span class="n">sotu_2009</span><span class="p">[</span><span class="s1">&#39;speechtext&#39;</span><span class="p">]</span>
<span class="n">text_2009</span> <span class="o">=</span> <span class="n">speechtext_2009</span><span class="o">.</span><span class="n">values</span>
<span class="n">strings_2009</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_2009</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">word_tokenize</span>

<span class="n">corpus_2008</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">strings_2008</span><span class="p">)</span>

<span class="n">corpus_2009</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">strings_2009</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us first strip out any extra white space that we do not need by using python’s replace(). Such extra whitespace can easily confuse our word recognition. Extra whitespaces can actually be a real issue in historical documents, as they have often been OCR’ed with imperfect recognition. Look it up! There are many cases described on the web. The Bad Data Handbook - Cleaning Up The Data So You Can Get Back To Work by McCallum and published by O’Reilly is an excellent summary of this other side of big data. The bigger the data the more likely it is also somehow ‘bad’!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corpus_2008</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">corpus_2008</span><span class="p">]</span>

<span class="n">corpus_2009</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">corpus_2009</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>But as we can see the tokenizer also sees punctuation as words, we need to do something about that. Python has a function isalpha(), that checks whether a token conists only of alphabetic lettters. This will also remove all numbers as they do not add to the content of the speeches. And maybe we also don’t want NLTK to distinguish between words with capital and lower letters, so let’s get rid of these as well. This makes it easier to count them. Why?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corpus_2008</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">corpus_2008</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()]</span>

<span class="n">corpus_2009</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">corpus_2009</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<p>When I said earlier that the most frequently used words carry the meaning of a document, I was not entirely telling the truth. There are so-called stopwords such as the, a, or, etc., which usually carry less meaning than the other expressions in the corpus. You will see what kind of words I mean by checking out NLTK’s stopwords corpus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="n">stopword_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))</span>
<span class="n">stopword_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;i&#39;,
 &#39;me&#39;,
 &#39;my&#39;,
 &#39;myself&#39;,
 &#39;we&#39;,
 &#39;our&#39;,
 &#39;ours&#39;,
 &#39;ourselves&#39;,
 &#39;you&#39;,
 &quot;you&#39;re&quot;,
 &quot;you&#39;ve&quot;,
 &quot;you&#39;ll&quot;,
 &quot;you&#39;d&quot;,
 &#39;your&#39;,
 &#39;yours&#39;,
 &#39;yourself&#39;,
 &#39;yourselves&#39;,
 &#39;he&#39;,
 &#39;him&#39;,
 &#39;his&#39;,
 &#39;himself&#39;,
 &#39;she&#39;,
 &quot;she&#39;s&quot;,
 &#39;her&#39;,
 &#39;hers&#39;,
 &#39;herself&#39;,
 &#39;it&#39;,
 &quot;it&#39;s&quot;,
 &#39;its&#39;,
 &#39;itself&#39;,
 &#39;they&#39;,
 &#39;them&#39;,
 &#39;their&#39;,
 &#39;theirs&#39;,
 &#39;themselves&#39;,
 &#39;what&#39;,
 &#39;which&#39;,
 &#39;who&#39;,
 &#39;whom&#39;,
 &#39;this&#39;,
 &#39;that&#39;,
 &quot;that&#39;ll&quot;,
 &#39;these&#39;,
 &#39;those&#39;,
 &#39;am&#39;,
 &#39;is&#39;,
 &#39;are&#39;,
 &#39;was&#39;,
 &#39;were&#39;,
 &#39;be&#39;,
 &#39;been&#39;,
 &#39;being&#39;,
 &#39;have&#39;,
 &#39;has&#39;,
 &#39;had&#39;,
 &#39;having&#39;,
 &#39;do&#39;,
 &#39;does&#39;,
 &#39;did&#39;,
 &#39;doing&#39;,
 &#39;a&#39;,
 &#39;an&#39;,
 &#39;the&#39;,
 &#39;and&#39;,
 &#39;but&#39;,
 &#39;if&#39;,
 &#39;or&#39;,
 &#39;because&#39;,
 &#39;as&#39;,
 &#39;until&#39;,
 &#39;while&#39;,
 &#39;of&#39;,
 &#39;at&#39;,
 &#39;by&#39;,
 &#39;for&#39;,
 &#39;with&#39;,
 &#39;about&#39;,
 &#39;against&#39;,
 &#39;between&#39;,
 &#39;into&#39;,
 &#39;through&#39;,
 &#39;during&#39;,
 &#39;before&#39;,
 &#39;after&#39;,
 &#39;above&#39;,
 &#39;below&#39;,
 &#39;to&#39;,
 &#39;from&#39;,
 &#39;up&#39;,
 &#39;down&#39;,
 &#39;in&#39;,
 &#39;out&#39;,
 &#39;on&#39;,
 &#39;off&#39;,
 &#39;over&#39;,
 &#39;under&#39;,
 &#39;again&#39;,
 &#39;further&#39;,
 &#39;then&#39;,
 &#39;once&#39;,
 &#39;here&#39;,
 &#39;there&#39;,
 &#39;when&#39;,
 &#39;where&#39;,
 &#39;why&#39;,
 &#39;how&#39;,
 &#39;all&#39;,
 &#39;any&#39;,
 &#39;both&#39;,
 &#39;each&#39;,
 &#39;few&#39;,
 &#39;more&#39;,
 &#39;most&#39;,
 &#39;other&#39;,
 &#39;some&#39;,
 &#39;such&#39;,
 &#39;no&#39;,
 &#39;nor&#39;,
 &#39;not&#39;,
 &#39;only&#39;,
 &#39;own&#39;,
 &#39;same&#39;,
 &#39;so&#39;,
 &#39;than&#39;,
 &#39;too&#39;,
 &#39;very&#39;,
 &#39;s&#39;,
 &#39;t&#39;,
 &#39;can&#39;,
 &#39;will&#39;,
 &#39;just&#39;,
 &#39;don&#39;,
 &quot;don&#39;t&quot;,
 &#39;should&#39;,
 &quot;should&#39;ve&quot;,
 &#39;now&#39;,
 &#39;d&#39;,
 &#39;ll&#39;,
 &#39;m&#39;,
 &#39;o&#39;,
 &#39;re&#39;,
 &#39;ve&#39;,
 &#39;y&#39;,
 &#39;ain&#39;,
 &#39;aren&#39;,
 &quot;aren&#39;t&quot;,
 &#39;couldn&#39;,
 &quot;couldn&#39;t&quot;,
 &#39;didn&#39;,
 &quot;didn&#39;t&quot;,
 &#39;doesn&#39;,
 &quot;doesn&#39;t&quot;,
 &#39;hadn&#39;,
 &quot;hadn&#39;t&quot;,
 &#39;hasn&#39;,
 &quot;hasn&#39;t&quot;,
 &#39;haven&#39;,
 &quot;haven&#39;t&quot;,
 &#39;isn&#39;,
 &quot;isn&#39;t&quot;,
 &#39;ma&#39;,
 &#39;mightn&#39;,
 &quot;mightn&#39;t&quot;,
 &#39;mustn&#39;,
 &quot;mustn&#39;t&quot;,
 &#39;needn&#39;,
 &quot;needn&#39;t&quot;,
 &#39;shan&#39;,
 &quot;shan&#39;t&quot;,
 &#39;shouldn&#39;,
 &quot;shouldn&#39;t&quot;,
 &#39;wasn&#39;,
 &quot;wasn&#39;t&quot;,
 &#39;weren&#39;,
 &quot;weren&#39;t&quot;,
 &#39;won&#39;,
 &quot;won&#39;t&quot;,
 &#39;wouldn&#39;,
 &quot;wouldn&#39;t&quot;]
</pre></div>
</div>
</div>
</div>
<p>Do you agree that these words do not really carry meaning in English? Stopwords should be removed to concentrate on the most important words. Let us do so by checking for each word in our corpus whether it is in the sopwords corpus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corpus_2008</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">corpus_2008</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopword_list</span><span class="p">]</span>

<span class="n">corpus_2009</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">corpus_2009</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopword_list</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let us next prepare a simple word cloud for both the corpora, by joining them. For this we will need to install wordcloud, in your terminal type pip install wordcloud.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span>

<span class="k">def</span> <span class="nf">make_wordcloud</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="n">wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> 
                <span class="n">background_color</span> <span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>  
                <span class="n">min_font_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">corpus</span><span class="p">))</span> 
  
    <span class="c1"># plot the WordCloud image</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span> 
    
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cor</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">corpus_2008</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">corpus_2009</span><span class="p">)</span>

<span class="n">make_wordcloud</span><span class="p">(</span><span class="n">cor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/Text_1_32_1.png" src="../../_images/Text_1_32_1.png" />
</div>
</div>
<p>We can clearly see that America is important in 2008 and in 2009 as well as the people of course. More interesting is probably the comparison of the 2008 speech by Bush with the 2009 speech by Obama. But for these we need to create two different corpuses, let’s take the same steps as before but now create two corpora, one for 2008 and one for 2009.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">make_wordcloud</span><span class="p">(</span><span class="n">corpus_2008</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/Text_1_34_1.png" src="../../_images/Text_1_34_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_wordcloud</span><span class="p">(</span><span class="n">corpus_2009</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/Text_1_35_1.png" src="../../_images/Text_1_35_1.png" />
</div>
</div>
<p>We can clearly see that Obama concentrated more on the economy while Bush’s favourite topic was the war on terror. We are quite happy with this insight but we also feel we can do better. Wouldn’t it be nice if we could compare not just words but whole topics across documents in a collection? This is what the advanced technique topic modelling does. Topic Modelling is a popular technique in social and cultural analytics that summarises a collection of texts into a predefined number of topics. Have a look at <a class="reference external" href="http://journalofdigitalhumanities.org/2-1/topic-modeling-and-digital-humanities-by-david-m-blei/">http://journalofdigitalhumanities.org/2-1/topic-modeling-and-digital-humanities-by-david-m-blei/</a>.</p>
<p>Topic modelling is also popular, as it requires only minimal text organisation. Computers can learn topics by themselves. There are, however, known limitations of topic models with regard to the interpretation they help with. There is no guarantee that the automatically derived topics will correspond to what people would consider to be interesting topics/themes. They may be too specific or general, identical to other topics or they may be framings of larger topics, as opposed to genuinely distinct topics. Finally (and in common with other computational analysis techniques), the performance of topic modelling depends upon the quality and structure of the data. In our case the main issue will be that we only have 2 documents, which is not a lot of data. But as topic modelling is computationally quite expensive we should not overdo things here and just concentrate on this small corpus.</p>
<p><a class="reference external" href="https://towardsdatascience.com/end-to-end-topic-modeling-in-python-latent-dirichlet-allocation-lda-35ce4ed6b3e0">https://towardsdatascience.com/end-to-end-topic-modeling-in-python-latent-dirichlet-allocation-lda-35ce4ed6b3e0</a> :Topic Models, in a nutshell, are a type of statistical language models used for uncovering hidden structure in a collection of texts. In a practical and more intuitively, you can think of it as a task of:
Dimensionality Reduction, where rather than representing a text T in its feature space as {Word_i: count(Word_i, T) for Word_i in Vocabulary}, you can represent it in a topic space as {Topic_i: Weight(Topic_i, T) for Topic_i in Topics}
Unsupervised Learning, where it can be compared to clustering, as in the case of clustering, the number of topics, like the number of clusters, is an output parameter. By doing topic modeling, we build clusters of words rather than clusters of texts. A text is thus a mixture of all the topics, each having a specific weight.</p>
<p>To create these topic models, we will create an LDA(Latent Dirichlet Allocation) model, using gensim, first install it using pip install gensim.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We need to install gensim for this</span>
<span class="kn">import</span> <span class="nn">gensim</span>
<span class="kn">import</span> <span class="nn">gensim.corpora</span> <span class="k">as</span> <span class="nn">corpora</span>

<span class="n">corpus_89</span> <span class="o">=</span> <span class="p">[</span><span class="n">corpus_2008</span><span class="p">,</span><span class="n">corpus_2009</span><span class="p">]</span>
<span class="n">Dict</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">corpus_89</span><span class="p">)</span>
<span class="n">texts</span> <span class="o">=</span> <span class="n">corpus_89</span>

<span class="c1"># Term Document Frequency</span>
<span class="n">td</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dict</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">LDA</span> <span class="o">=</span> <span class="n">gensim</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">LdaMulticore</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">td</span><span class="p">,</span>
                                       <span class="n">id2word</span><span class="o">=</span><span class="n">Dict</span><span class="p">,</span>
                                       <span class="n">num_topics</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we want to print the most keywords in the 10 topics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">LDA</span><span class="o">.</span><span class="n">print_topics</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0,
  &#39;0.007*&quot;new&quot; + 0.006*&quot;must&quot; + 0.006*&quot;people&quot; + 0.006*&quot;america&quot; + &#39;
  &#39;0.006*&quot;american&quot; + 0.006*&quot;also&quot; + 0.005*&quot;us&quot; + 0.004*&quot;year&quot; + &#39;
  &#39;0.004*&quot;congress&quot; + 0.004*&quot;years&quot;&#39;),
 (1,
  &#39;0.007*&quot;america&quot; + 0.006*&quot;people&quot; + 0.006*&quot;new&quot; + 0.006*&quot;american&quot; + &#39;
  &#39;0.006*&quot;us&quot; + 0.005*&quot;congress&quot; + 0.005*&quot;must&quot; + 0.004*&quot;also&quot; + &#39;
  &#39;0.004*&quot;health&quot; + 0.004*&quot;care&quot;&#39;),
 (2,
  &#39;0.007*&quot;america&quot; + 0.007*&quot;us&quot; + 0.006*&quot;american&quot; + 0.006*&quot;must&quot; + &#39;
  &#39;0.006*&quot;people&quot; + 0.005*&quot;new&quot; + 0.004*&quot;nation&quot; + 0.004*&quot;congress&quot; + &#39;
  &#39;0.004*&quot;iraq&quot; + 0.003*&quot;also&quot;&#39;),
 (3,
  &#39;0.006*&quot;must&quot; + 0.005*&quot;congress&quot; + 0.005*&quot;people&quot; + 0.005*&quot;american&quot; + &#39;
  &#39;0.005*&quot;year&quot; + 0.005*&quot;america&quot; + 0.004*&quot;new&quot; + 0.004*&quot;us&quot; + 0.004*&quot;help&quot; + &#39;
  &#39;0.004*&quot;health&quot;&#39;),
 (4,
  &#39;0.006*&quot;must&quot; + 0.006*&quot;people&quot; + 0.005*&quot;american&quot; + 0.005*&quot;america&quot; + &#39;
  &#39;0.005*&quot;also&quot; + 0.005*&quot;year&quot; + 0.004*&quot;new&quot; + 0.004*&quot;congress&quot; + 0.004*&quot;us&quot; + &#39;
  &#39;0.004*&quot;nation&quot;&#39;),
 (5,
  &#39;0.006*&quot;america&quot; + 0.005*&quot;american&quot; + 0.005*&quot;must&quot; + 0.005*&quot;new&quot; + &#39;
  &#39;0.005*&quot;people&quot; + 0.005*&quot;us&quot; + 0.005*&quot;nation&quot; + 0.005*&quot;year&quot; + &#39;
  &#39;0.004*&quot;congress&quot; + 0.004*&quot;help&quot;&#39;),
 (6,
  &#39;0.009*&quot;people&quot; + 0.008*&quot;america&quot; + 0.007*&quot;congress&quot; + 0.007*&quot;new&quot; + &#39;
  &#39;0.006*&quot;american&quot; + 0.006*&quot;must&quot; + 0.005*&quot;economy&quot; + 0.005*&quot;us&quot; + &#39;
  &#39;0.005*&quot;year&quot; + 0.005*&quot;help&quot;&#39;),
 (7,
  &#39;0.006*&quot;american&quot; + 0.006*&quot;new&quot; + 0.005*&quot;also&quot; + 0.005*&quot;us&quot; + 0.005*&quot;people&quot; &#39;
  &#39;+ 0.004*&quot;america&quot; + 0.004*&quot;plan&quot; + 0.004*&quot;health&quot; + 0.004*&quot;economy&quot; + &#39;
  &#39;0.004*&quot;know&quot;&#39;),
 (8,
  &#39;0.007*&quot;people&quot; + 0.007*&quot;must&quot; + 0.006*&quot;america&quot; + 0.006*&quot;us&quot; + 0.006*&quot;new&quot; &#39;
  &#39;+ 0.005*&quot;year&quot; + 0.004*&quot;also&quot; + 0.004*&quot;nation&quot; + 0.004*&quot;american&quot; + &#39;
  &#39;0.004*&quot;congress&quot;&#39;),
 (9,
  &#39;0.006*&quot;american&quot; + 0.006*&quot;america&quot; + 0.005*&quot;new&quot; + 0.005*&quot;us&quot; + &#39;
  &#39;0.005*&quot;people&quot; + 0.005*&quot;congress&quot; + 0.005*&quot;must&quot; + 0.004*&quot;know&quot; + &#39;
  &#39;0.004*&quot;health&quot; + 0.003*&quot;care&quot;&#39;)]
</pre></div>
</div>
</div>
</div>
<p>So how do we interpret this? It shows the top 10 keywords that contribute to each topic.</p>
<p>For example the keywords for topic 0 are: ‘america’, ‘new’, ‘congress’.. etc and the weight of ‘america’ on topic 0 is 0.007, it shows how important the keyword is to that topic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LDA</span><span class="o">.</span><span class="n">show_topic</span><span class="p">(</span><span class="n">topicid</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">topn</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;must&#39;, 0.006321575),
 (&#39;people&#39;, 0.006150045),
 (&#39;american&#39;, 0.005441544),
 (&#39;america&#39;, 0.0054138904),
 (&#39;also&#39;, 0.0052484265),
 (&#39;year&#39;, 0.0047444524),
 (&#39;new&#39;, 0.0042508068),
 (&#39;congress&#39;, 0.00411696),
 (&#39;us&#39;, 0.003982409),
 (&#39;nation&#39;, 0.0037970436),
 (&#39;iraq&#39;, 0.0037877744),
 (&#39;country&#39;, 0.0032802399),
 (&#39;time&#39;, 0.0032238397),
 (&#39;help&#39;, 0.0031466163),
 (&#39;care&#39;, 0.0031044504),
 (&#39;world&#39;, 0.003005896),
 (&#39;one&#39;, 0.0029818958),
 (&#39;years&#39;, 0.0029387348),
 (&#39;health&#39;, 0.0028465912),
 (&#39;every&#39;, 0.0028406703)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gensim LDA doesn&#39;t easily allow for the comparison of the topic models to each of the documents</span>
<span class="c1"># other options are possible though, but what would be suited for the assignment?</span>
</pre></div>
</div>
</div>
</div>
<p>Not bad. Both word clouds and topic modelling deliver some interesting insights. We now feel confident to explore the whole corpus. In the end, we would like to establish some simple linguistic statistics such as the most frequent words/terms in a collection as well as word trends that tell us about the ups and downs of concepts during the history of policy-making in the USA. Check out <a class="reference external" href="http://stateoftheunion.onetwothree.net/sotuGraph/index.html">http://stateoftheunion.onetwothree.net/sotuGraph/index.html</a> for a visualisation to compare two concepts in the SOTU speeches.</p>
<p>Let us start by creating first a corpus for each speechtext,</p>
<p>Remember the previous steps? Let’s first tokeninze the words</p>
<p>Next, we remove the numbers and whitespaces, please. Do you remember how?</p>
<p>And at last we remove the stopwords</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">speech</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;speechtext&#39;</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">speech</span><span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()]</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopword_list</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;speechtext&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="n">docs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">docs</span><span class="p">,</span> <span class="n">df</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">docs</span><span class="p">,</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rownames</th>
      <th>speechtext</th>
      <th>year</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17900108.html</td>
      <td>['senate', 'house', 'representatives', 'embrac...</td>
      <td>1790</td>
      <td>1970-01-01 00:00:00.017900108</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17901208.html</td>
      <td>['senate', 'house', 'representatives', 'meetin...</td>
      <td>1790</td>
      <td>1970-01-01 00:00:00.017901208</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17911025.html</td>
      <td>['senate', 'house', 'representatives', 'vain',...</td>
      <td>1791</td>
      <td>1970-01-01 00:00:00.017911025</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17921106.html</td>
      <td>['senate', 'house', 'representatives', 'abatem...</td>
      <td>1792</td>
      <td>1970-01-01 00:00:00.017921106</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17931203.html</td>
      <td>['senate', 'house', 'representatives', 'since'...</td>
      <td>1793</td>
      <td>1970-01-01 00:00:00.017931203</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>226</th>
      <td>20130212.html</td>
      <td>['speaker', 'vice', 'president', 'members', 'c...</td>
      <td>2013</td>
      <td>1970-01-01 00:00:00.020130212</td>
    </tr>
    <tr>
      <th>227</th>
      <td>20140128.html</td>
      <td>['speaker', 'vice', 'president', 'members', 'c...</td>
      <td>2014</td>
      <td>1970-01-01 00:00:00.020140128</td>
    </tr>
    <tr>
      <th>228</th>
      <td>20150120.html</td>
      <td>['speaker', 'vice', 'president', 'members', 'c...</td>
      <td>2015</td>
      <td>1970-01-01 00:00:00.020150120</td>
    </tr>
    <tr>
      <th>229</th>
      <td>20160112.html</td>
      <td>['speaker', 'vice', 'president', 'members', 'c...</td>
      <td>2016</td>
      <td>1970-01-01 00:00:00.020160112</td>
    </tr>
    <tr>
      <th>230</th>
      <td>20170228.html</td>
      <td>['thank', 'much', 'speaker', 'vice', 'presiden...</td>
      <td>2017</td>
      <td>1970-01-01 00:00:00.020170228</td>
    </tr>
  </tbody>
</table>
<p>231 rows × 4 columns</p>
</div></div></div>
</div>
<p>We are ready to create a document term matrix, we will use tdidf for that.</p>
<p>Sklearn has a nice tool for that, the TfidfVectorizer, <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html</a>
which converts a collection of documents o a matrix of TF-IDF features.</p>
<p>TF-IDF stands for term frequency–inverse document frequency, it shows you how important a word is for a document in a corpus.
(Maybe show the formula here? Do we need more explaining?)</p>
<p>Use the vectorizer to calculate the TF-IDF and then use these values to create a new dataframe, the document term matrix, that shows for each speech (as a column) the word (row) and its tf-idf (value).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">tfidf</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">vec</span> <span class="o">=</span> <span class="n">tfidf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;speechtext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
 
<span class="n">matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">tfidf</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
 
<span class="n">matrix</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
<span class="n">matrix</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1790</th>
      <th>1790</th>
      <th>1791</th>
      <th>1792</th>
      <th>1793</th>
      <th>1794</th>
      <th>1795</th>
      <th>1796</th>
      <th>1797</th>
      <th>1798</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>aaa</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>aana</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>aaron</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abandon</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.02475</td>
      <td>...</td>
      <td>0.009383</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.008981</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.008578</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abandoned</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.027036</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abandoning</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abandonment</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.01462</td>
    </tr>
    <tr>
      <th>abandons</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abate</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abated</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abatement</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.056124</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abating</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abbas</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abbreviation</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abdicate</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abdicated</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abdicating</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abdication</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abducted</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>abduction</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00000</td>
    </tr>
  </tbody>
</table>
<p>20 rows × 231 columns</p>
</div></div></div>
</div>
<p>We could also get a word frequency count, which gives a more simple overview by using the same set up but instead we use CountVectorizer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;speechtext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">count</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span>
                      <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>

<span class="n">count_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">count</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>

<span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
<span class="n">count_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1790</th>
      <th>1790</th>
      <th>1791</th>
      <th>1792</th>
      <th>1793</th>
      <th>1794</th>
      <th>1795</th>
      <th>1796</th>
      <th>1797</th>
      <th>1798</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>aaa</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>aana</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>aaron</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>abandon</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>abandoned</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>zone</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>zones</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>zoological</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>zooming</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>zuloaga</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>23070 rows × 231 columns</p>
</div></div></div>
</div>
<p>Well we mainly see a lot of zero values, probably because it the words are sorted in alphabetical order. Is there something we could do about that?</p>
<p>We can, for example, sort it in ascending order for a certain year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_new</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="mi">1791</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
<span class="n">count_new</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1790</th>
      <th>1790</th>
      <th>1791</th>
      <th>1792</th>
      <th>1793</th>
      <th>1794</th>
      <th>1795</th>
      <th>1796</th>
      <th>1797</th>
      <th>1798</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>states</th>
      <td>4</td>
      <td>3</td>
      <td>18</td>
      <td>5</td>
      <td>24</td>
      <td>19</td>
      <td>5</td>
      <td>16</td>
      <td>18</td>
      <td>15</td>
      <td>...</td>
      <td>5</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>10</td>
      <td>12</td>
      <td>14</td>
      <td>9</td>
      <td>6</td>
      <td>12</td>
    </tr>
    <tr>
      <th>united</th>
      <td>4</td>
      <td>2</td>
      <td>17</td>
      <td>5</td>
      <td>22</td>
      <td>15</td>
      <td>5</td>
      <td>16</td>
      <td>18</td>
      <td>14</td>
      <td>...</td>
      <td>4</td>
      <td>5</td>
      <td>7</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
      <td>7</td>
      <td>3</td>
      <td>14</td>
    </tr>
    <tr>
      <th>may</th>
      <td>5</td>
      <td>6</td>
      <td>13</td>
      <td>6</td>
      <td>8</td>
      <td>12</td>
      <td>7</td>
      <td>12</td>
      <td>8</td>
      <td>6</td>
      <td>...</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>public</th>
      <td>5</td>
      <td>5</td>
      <td>10</td>
      <td>5</td>
      <td>7</td>
      <td>4</td>
      <td>7</td>
      <td>11</td>
      <td>5</td>
      <td>4</td>
      <td>...</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>upon</th>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>11</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fading</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>fades</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>faded</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>fade</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>zuloaga</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>23070 rows × 231 columns</p>
</div></div></div>
</div>
<p>We can also view only subparts the dataframe and sort for each year seperately and compare them with another year.</p>
<p>Let’s try and do this for 2016 and 2017</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat_2016</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="mi">2016</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mat_1617</span> <span class="o">=</span> <span class="n">mat_2016</span><span class="p">[[</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">]]</span>
<span class="n">mat_1617</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>us</th>
      <td>33</td>
      <td>20</td>
    </tr>
    <tr>
      <th>america</th>
      <td>26</td>
      <td>29</td>
    </tr>
    <tr>
      <th>world</th>
      <td>25</td>
      <td>17</td>
    </tr>
    <tr>
      <th>people</th>
      <td>21</td>
      <td>15</td>
    </tr>
    <tr>
      <th>work</th>
      <td>20</td>
      <td>10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>farmer</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>farmed</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>farman</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>farm</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>zuloaga</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>23070 rows × 2 columns</p>
</div></div></div>
</div>
<p>If we want, we could also check the wordcount of each speech by summing up the values of each of the columns, pandas has a good function for that, look it up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year
1790     497
1790     629
1791    1064
1792     961
1793     896
        ... 
2013    3379
2014    3544
2015    3418
2016    2716
2017    2569
Length: 231, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Interesting! If we would run this function on the whole dtm, we could filter out the shortest and longest speeches using the subset, min and max functions. Any idea how?</p>
<p>But we move on, as we are more interested in the words/terms and their frequencies, which will tell us more about the contents of the various speeches.
We could also use the same function to check how many times a certain word occurs in all of the documents, try it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word_freq</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">word_freq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>aaa            1
aana           2
aaron          2
abandon       80
abandoned     82
              ..
zone          37
zones         19
zoological     1
zooming        1
zuloaga        5
Length: 23070, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Again, a bit much since there are so many words, let’s have a look at the 10 most frequent ones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word_freq</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>government    6951
states        6475
congress      4996
united        4819
people        4064
upon          3956
year          3899
would         3787
country       3422
may           3407
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can calculate the correlation between two words by calculating the correlation between two dataframe columns (this does mean that we have to transpose the datframe first)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">T</span>

<span class="k">def</span> <span class="nf">find_cors</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">term</span><span class="p">):</span>
    <span class="n">cors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">term</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
        <span class="n">cors</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>
    <span class="k">return</span> <span class="n">cors</span>

<span class="n">cors</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can find talk on jobs, children, families, etc. and lots of other promises to America. What about peace? Run find_cors() again but then with the term ‘peace’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cors_peace</span> <span class="o">=</span> <span class="n">find_cors</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;peace&#39;</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">cors_peace</span><span class="p">)</span> 
  
<span class="n">highest</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">highest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;peace&#39;, 1.0), (&#39;war&#39;, 0.5934693644098213), (&#39;forces&#39;, 0.5477506504609714), (&#39;military&#39;, 0.5396034510531938), (&#39;nations&#39;, 0.5314085270251379), (&#39;army&#39;, 0.5254546322919678), (&#39;contributions&#39;, 0.5170881559320253), (&#39;peoples&#39;, 0.48644654058611475), (&#39;occupation&#39;, 0.4742004312536388), (&#39;nation&#39;, 0.4714783974953244)]
</pre></div>
</div>
</div>
</div>
<p>Well, it seems that peace is mainly a thing of war! Quite sad now about the world, we move on from the simple linguistic statistics we have done so far - mainly based on word frequencies. Next, we enter the domain of word trends, which are currently hotly debated as a digital method. We would like to plot them as we have seen them earlier on the SOTU website. We already have the dataframe for that, the one with all the word counts for each year, let’s use that to plot the trend of ‘america’ over the years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_america</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;america&#39;</span><span class="p">])</span>
<span class="n">df_america</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>america</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1790</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1790</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1791</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1792</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1793</th>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>27</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>34</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>38</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>26</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>29</td>
    </tr>
  </tbody>
</table>
<p>231 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_america</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;year&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Text_1_67_1.png" src="../../_images/Text_1_67_1.png" />
</div>
</div>
<p>For comparison, we add another line-plot about citizens</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_compare</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;america&#39;</span><span class="p">,</span> <span class="s1">&#39;citizen&#39;</span><span class="p">])</span>
<span class="n">df_compare</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Text_1_69_0.png" src="../../_images/Text_1_69_0.png" />
</div>
</div>
<p>Overall, the plot is not very nice. This is part of the limitation of the built-in plotting function. It is a quick solution but often not a very pretty one. Good for data exploration but not representation! Later in the course, we will meet a much more powerful plotting package called seaborn. As a little preview, we would like to use it next to visualise word trends. Use the same code as above, but before doing so install and import seaborn and type sns.set()</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">df_compare</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Text_1_71_0.png" src="../../_images/Text_1_71_0.png" />
</div>
</div>
<p>Let’s check what we have learned next.</p>
<p>What does TF-IDF stand for? (Have to find some other answers for these)</p>
<ol class="simple">
<li><p>TextDealingsManager</p></li>
<li><p>TexasDallasMountains</p></li>
<li><p>TermDocumentMatrix</p></li>
<li><p>Don’t know</p></li>
</ol>
<p>Term frequency–inverse document frequency</p>
<p>In the content transformation workflow of the tm package for corp_small, how do I transform the content into lower cases?</p>
<ol class="simple">
<li><p>word.lower()</p></li>
<li><p>tm_map(corp_small, content_transformer(tolower))</p></li>
<li><p>tm_map(corp_small, removeNumbers)</p></li>
<li><p>tm_map(corp_small, tolower)</p></li>
</ol>
<p>word.lower()</p>
<p>Create a new plot for the historical development of the idea of ‘history’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_history</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">])</span>
<span class="n">df_history</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;year&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/Text_1_73_1.png" src="../../_images/Text_1_73_1.png" />
</div>
</div>
<p>Find the word associations with ‘history’ in the speeches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cors_history</span> <span class="o">=</span> <span class="n">find_cors</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;history&#39;</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">cors_history</span><span class="p">)</span> 
  
<span class="n">highest</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">highest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;history&#39;, 1.0), (&#39;world&#39;, 0.5506352648608028), (&#39;years&#39;, 0.5299129845559173), (&#39;new&#39;, 0.5035340261157771), (&#39;ago&#39;, 0.46575563901563594), (&#39;us&#39;, 0.4579664853277646), (&#39;people&#39;, 0.45311911535390026), (&#39;president&#39;, 0.44309687427868005), (&#39;life&#39;, 0.4401603707428053), (&#39;peaceful&#39;, 0.4398454376297889)]
</pre></div>
</div>
</div>
</div>
<p>Within your working group, go back to the ten topics you have found and try and give each of them a title that describes it. Sometimes this is not so easy, because the corpus is quite small. But do try your best.</p>
<p>Let’s move on to the second part of this session.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Notebooks/Text"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../../HistoricalCultures.html" title="previous page">Historical Cultures</a>
    <a class='right-next' id="next-link" href="Text_2.html" title="next page">Analysing Historical Cultures 2</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By DIMPAH<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>